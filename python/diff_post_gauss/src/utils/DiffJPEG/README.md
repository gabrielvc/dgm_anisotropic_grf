Code adapted from https://github.com/mlomnitz/DiffJPEG

"Adaption" is restricted to changing files names and altering the imports to align with the repository structure.
